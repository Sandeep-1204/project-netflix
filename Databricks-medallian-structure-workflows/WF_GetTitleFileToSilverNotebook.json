resources:
  jobs:
    WF_GetTitleFileToSilverNotebook:
      name: WF_GetTitleFileToSilverNotebook
      tasks:
        - task_key: Weekday_lookup
          notebook_task:
            notebook_path: /Repos/sandeepadhi1@outlook.com/project-netflix/databricks-notebooks/Title-transformation-run-lookup
            base_parameters:
              weekday: "{{job.start_time.iso_weekday}}"
            source: WORKSPACE
          existing_cluster_id: 0521-071110-pnw90ont
        - task_key: Check_if_sunday
          depends_on:
            - task_key: Weekday_lookup
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.Weekday_lookup.values.weekoutput}}"
            right: "7"
        - task_key: Silver_stage_title_file_transformation
          depends_on:
            - task_key: Check_if_sunday
              outcome: "true"
          notebook_task:
            notebook_path: /Repos/sandeepadhi1@outlook.com/project-netflix/databricks-notebooks/Silver_stage_transformation
            source: WORKSPACE
          existing_cluster_id: 0521-071110-pnw90ont
        - task_key: FalseNotebook
          depends_on:
            - task_key: Check_if_sunday
              outcome: "false"
          notebook_task:
            notebook_path: /Repos/sandeepadhi1@outlook.com/project-netflix/databricks-notebooks/weekday_number_lookup
            source: WORKSPACE
          existing_cluster_id: 0521-071110-pnw90ont
      queue:
        enabled: true
